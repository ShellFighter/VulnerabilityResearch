
## Reflected XSS in SCADA software - LAquis

## Affected vendor

LCDS LAquis SCADA

## Affected Version

Versions 4.7.1.511

## Description


A reflected XSS vulnerability was identified in the GET of the [http://localhost:1234/relatorionome.lhtml?ID=26092412431648679700&TAG=&NOME=SIMPLE1&TITULO=[XSS payload]] . This vulnerability allows an attacker to inject arbitrary JavaScript code into a web page, which is then reflected back to the user. The attack is executed within the context of the user's browser session.


## Steps to reproduce this vulnerability:

1. Identify a Vulnerable Input:

- The attacker first identifies a parameter or input field on the web application that reflects user input without proper sanitization or escaping.

http://localhost:1234/relatorionome.lhtml?ID=26092412431648679700&TAG=&NOME=SIMPLE1&TITULO=[Report]


2. Craft a Malicious Payload:

- The attacker creates a malicious script payload that will be executed when reflected in the response. For example:

http://localhost:1234/relatorionome.lhtml?ID=26092412431648679700&TAG=&NOME=SIMPLE1&TITULO=%3Cimg%20src=%22x%22%20onerror=%22alert(%27XSS%27)%22%3E

- This payload could be more complex, involving stealing cookies, redirecting the user, or performing unauthorized actions.

## Discovery

The vulnerability was discovered through security testing of the GUI of the web server linked to the SCADA application. During the testing process, a particular parameter in the application was found to reflect user input back to the web page without proper sanitization or escaping.

## PoC

![image](https://github.com/user-attachments/assets/becb7388-744d-42e2-b10d-c20dcda2f025)

Click on the Menu, Select the option Application, WEB Server â€¦, Activate WEB server like this:

![image](https://github.com/user-attachments/assets/2e1ed99a-f94e-4495-a101-bcde08aff546)

![image](https://github.com/user-attachments/assets/84917a08-ab74-4e39-9507-583a211741ac)

![image](https://github.com/user-attachments/assets/57f41311-9d93-468d-9c55-7c51d7264ef5)

![image](https://github.com/user-attachments/assets/9413c99c-0a53-42be-8875-9d87e6bde2e6)

![image](https://github.com/user-attachments/assets/51a7f712-7a26-4fd9-8dea-f49b15bec474)


## Researcher

Mounir Aarab (NTT Belgium)
